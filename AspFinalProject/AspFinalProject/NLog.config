<!--<?xml version="1.0" encoding="utf-8" ?>
<nlog xmlns="http://www.nlog-project.org/schemas/NLog.xsd"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.nlog-project.org/schemas/NLog.xsd NLog.xsd"
      autoReload="true"
      throwExceptions="false"
      internalLogLevel="Off" internalLogFile="c:\temp\nlog-internal.log">

  --><!-- optional, add some variables
  https://github.com/nlog/NLog/wiki/Configuration-file#variables
  --><!--
  <variable name="myvar" value="myvalue"/>

  --><!--
  See https://github.com/nlog/nlog/wiki/Configuration-file
  for information on customizing logging rules and outputs.
   --><!--
  <targets>

    --><!--
    add your targets here
    See https://github.com/nlog/NLog/wiki/Targets for possible targets.
    See https://github.com/nlog/NLog/wiki/Layout-Renderers for the possible layout renderers.
    --><!--

    

    --><!--Write events to a file with the date in the filename.--><!--
    <target xsi:type="File" name="f" fileName="${basedir}/logs/${shortdate}.log"
            layout="${longdate} ${uppercase:${level}} ${message}" />

    <target name="mail" xsi:type="Mail"
       subject="${var:appName}"
       smtpServer="smtp.mail.ru"
       smtpPort="25"
       smtpAuthentication="Basic"
       smtpUserName="fullstackstaff"
       smtpPassword="!d@v#l0pmentgroup20!9"
       enableSsl="true"
       from="fullstackstaff@mail.ru"
       to="iqbal.hoff@list.ru"
       cc="${var:ccMails}"
          />
  </targets>
 


  <rules>
    --><!-- add your logging rules here --><!--

    --><!--Write all events with minimal level of Debug (So Debug, Info, Warn, Error and Fatal, but not Trace)  to "f"--><!--
    <logger name="*" minlevel="Debug" writeTo="f" />
    <logger name="*" levels ="Error,Fatal" writeTo="mail" />


  </rules>
</nlog>-->

<nlog xmlns="http://vizew.az/schemas/NLog.xsd" xmlns:xsi="http://vizew.az">
  <!--<variable name="callsite-filesource" value="${callsite:className=false:includeNamespace=false:fileName=true:includeSourcePath=true:methodName=false:cleanNamesOfAnonymousDelegates=true:skipFrames=1}" />-->
  <variable name="appName" value="CV" />
  <variable name="toMail" value="akamran@code.edu.az" />
  <variable name="ccMails" value="" />
  
  <variable name="callsite-methodname" value="${callsite:className=true:includeNamespace=true:fileName=false:includeSourcePath=false:methodName=true:cleanNamesOfAnonymousDelegates=true}" />
  <variable name="callsite-filesource" value="${callsite:className=false:includeNamespace=false:fileName=true:includeSourcePath=true:methodName=false:cleanNamesOfAnonymousDelegates=true}" />
  <targets>
    <target name="default" xsi:type="File"
              fileName="${basedir}/Logs/Default.log"
              layout="${longdate} ${level:uppercase=true:padding=5} ${session} ${storeid} ${msisdn} - ${message}  ${exception:format=tostring}"
              archiveEvery="Day"
              archiveFileName="${basedir}/Logs/Default_{#}.log"
              archiveNumbering="Date"
              archiveDateFormat="yyyyMMdd"
              maxArchiveFiles="14"
              keepFileOpen="true"
              
            />

    <target name="errors" xsi:type="File"
              fileName="${basedir}/Logs/Error.log"
              layout="${longdate} ${level:uppercase=true:padding=5} ${session} ${storeid} ${msisdn} -${message} ${exception:format=tostring}"
              archiveEvery="Day"
              archiveFileName="${basedir}/Logs/Error_{#}.log"
              archiveNumbering="Date"
           archiveDateFormat="yyyyMMdd"
              maxArchiveFiles="14"
              keepFileOpen="true"
            />

    <target name="mail" xsi:type="Mail"
        subject="${var:appName}"
        smtpServer="smtp.mail.ru"
        smtpPort="25"
        smtpAuthentication="Basic"
        smtpUserName="fullstackstaff"
        smtpPassword="!d@v#l0pmentgroup20!9"
        enableSsl="true"
        from="fullstackstaff@mail.ru"
        to="iqbal.hoff@list.ru"
        cc=""
          />
    
    <target name="database" xsi:type="Database" >
      <connectionString>data source=DESKTOP-GV6AT7I\SQLEXPRESS;initial catalog=MyCv;Integrated Security=true;application name="${var:appName}"</connectionString>

      <!---->
      <commandText>dbo.spLogger</commandText>
      <commandType>StoredProcedure</commandType>
      <parameter name="@application" layout="${var:appName}" />
      <parameter name="@level" layout="${level}" />
      <parameter name="@message" layout="${message}" />
      <parameter name="@logger" layout="${logger}" />
      <parameter name="@memberName" layout="${var:callsite-methodname}"/>
      <parameter name="@sourceFilePath" layout="${var:callsite-filesource}"/>
      <parameter name="@errorLine" layout="${callsite-linenumber}"/>
      
    </target>
    
  </targets>
  <rules>
    <logger name="*" levels ="Trace,Debug,Info,Warn" writeTo="default" />
    <logger name="*" levels ="Error,Fatal" writeTo="errors" />
    <logger name="*" levels ="Error,Fatal" writeTo="mail" />
  </rules>
</nlog>
